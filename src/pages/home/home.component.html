
<div class="container mx-auto px-4 py-8 space-y-12">
  
  <!-- Search and Filter Section -->
  <div class="bg-surface/50 p-6 rounded-lg shadow-lg">
    <h2 class="text-2xl font-bold mb-4">{{ 'advancedSearch' | translate }}</h2>
    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4">
      <select [ngModel]="selectedGenre()" (ngModelChange)="selectedGenre.set($event)" class="bg-surface-light text-text-primary p-3 rounded-md focus:outline-none focus:ring-2 focus:ring-primary border border-transparent focus:border-primary">
        <option value="">{{ 'allGenres' | translate }}</option>
        @for (genre of genres; track genre) {
          <option [value]="genre">{{ genre }}</option>
        }
      </select>
      <select [ngModel]="selectedAudioLang()" (ngModelChange)="selectedAudioLang.set($event)" class="bg-surface-light text-text-primary p-3 rounded-md focus:outline-none focus:ring-2 focus:ring-primary border border-transparent focus:border-primary">
        <option value="">{{ 'allAudio' | translate }}</option>
        @for (lang of audioLanguages; track lang) {
          <option [value]="lang">{{ lang }}</option>
        }
      </select>
       <select [ngModel]="selectedType()" (ngModelChange)="selectedType.set($event)" class="bg-surface-light text-text-primary p-3 rounded-md focus:outline-none focus:ring-2 focus:ring-primary border border-transparent focus:border-primary">
        <option value="">{{ 'allTypes' | translate }}</option>
        <option value="Movie">{{ 'movies' | translate }}</option>
        <option value="TV Show">{{ 'tvShows' | translate }}</option>
      </select>
      <select [ngModel]="selectedYear()" (ngModelChange)="selectedYear.set($event ? +$event : null)" class="bg-surface-light text-text-primary p-3 rounded-md focus:outline-none focus:ring-2 focus:ring-primary border border-transparent focus:border-primary">
        <option value="">{{ 'allYears' | translate }}</option>
        @for (year of years(); track year) {
          <option [value]="year">{{ year }}</option>
        }
      </select>
       <button class="bg-surface-light/50 border border-border text-text-primary p-3 rounded-md hover:bg-surface-light transition-colors duration-200">
        {{ 'clearFilters' | translate }}
      </button>
    </div>
  </div>

  <!-- Recently Watched Section -->
  @if (currentUser() && recentlyWatchedMedia().length > 0) {
    <div>
      <h2 class="text-3xl font-bold mb-6">{{ 'recentlyWatched' | translate }}</h2>
      <div class="flex overflow-x-auto gap-6 pb-4 -mx-4 px-4">
        @for (item of recentlyWatchedMedia(); track item.media.id) {
          <div class="flex-shrink-0 w-[160px]">
            <app-media-card [media]="item.media" [watchedItem]="item.watchedItem" />
          </div>
        }
      </div>
    </div>
  }

  <!-- Media Grid -->
  @if (filteredMedia().length > 0) {
    <div>
      <h2 class="text-3xl font-bold mb-6">{{ 'allContent' | translate }}</h2>
      <div class="flex overflow-x-auto gap-6 pb-4 -mx-4 px-4">
        @for (media of filteredMedia(); track media.id) {
          <div class="flex-shrink-0 w-[160px]">
            <app-media-card [media]="media" />
          </div>
        }
      </div>
    </div>
  } @else {
    <div class="text-center py-20">
      <p class="text-text-secondary text-2xl">{{ 'noResultsFound' | translate }}</p>
    </div>
  }
</div>
